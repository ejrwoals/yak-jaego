# 약국 재고 관리 및 분석 시스템 (Jaego)

## 🏥 프로젝트 개요

**Jaego**는 약국의 재고 관리와 사용량 분석을 위한 Python 기반 자동화 도구입니다. Excel/CSV 형태의 약품 사용량 데이터를 분석하여 재고 운영 효율성을 높이고, 시각적으로 이해하기 쉬운 HTML 보고서를 생성합니다.

### 📊 주요 기능

- **다양한 파일 형식 지원**: Excel(.xls, .xlsx), CSV 파일 자동 인식 및 처리
- **강력한 데이터 처리**: 파일 인코딩 자동 감지 및 다양한 Excel 엔진 지원
- **재고 분석**: 월평균 조제수량 계산 및 재고 소진 예상 기간(런웨이) 산출
- **인터랙티브 시각화**: Plotly 기반의 동적 차트 생성
- **전문적인 HTML 보고서**: 완전한 재고 현황 대시보드 자동 생성
- **사용자 친화적 인터페이스**: 직관적인 파일 선택 및 설정 과정

## 🚀 빠른 시작

### 필수 요구사항

- Python 3.7 이상
- pip (Python 패키지 관리자)

### 설치 방법

1. **저장소 클론**
   ```bash
   git clone https://github.com/yourusername/jaego.git
   cd jaego
   ```

2. **가상환경 설정 (권장)**
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   ```

3. **의존성 설치**
   ```bash
   pip install -r requirements.txt
   ```

### 데이터 준비

1. `data/` 폴더에 약품 사용량 Excel 또는 CSV 파일을 저장
2. 파일은 다음 컬럼을 포함해야 합니다:
   - `약품명`: 의약품명
   - `제약회사`: 제조회사명
   - `약품코드`: 고유 식별 코드
   - `재고수량`: 현재 재고량
   - `조제수량`: 기간별 사용량

## 📖 사용 방법

### 1. 데이터 분석 및 처리

```bash
python read_excel.py
```

**실행 과정:**
1. `data/` 폴더의 파일 목록 표시
2. 분석할 파일 선택
3. 데이터 기간(개월 수) 입력
4. 자동 데이터 처리 및 검증
5. 처리된 결과를 CSV로 저장 옵션

**지원하는 파일 형식:**
- Excel: `.xls`, `.xlsx` (multiple engine support)
- CSV: UTF-8, CP949 인코딩 자동 감지
- 손상된 파일에 대한 LibreOffice 변환 백업

### 2. HTML 보고서 생성

```bash
python generate_report.py
```

**생성되는 보고서 내용:**
- 📈 재고 현황 요약 통계
- 📊 인터랙티브 차트 (재고 분포, TOP 약품 등)
- 🔍 상세 재고 테이블 (검색/정렬 기능)
- ⚠️ 주의사항 약품 목록 (재고 부족/과다)
- 📱 반응형 디자인 (모바일 최적화)

## 📁 프로젝트 구조

```
jaego/
├── data/                          # 입력 데이터 폴더
│   ├── 12개월간사용량(24925-250926).csv
│   ├── 12개월간사용량(24925-250926).xls
│   ├── 6개월간사용량(250325-250926).csv
│   └── ...
├── read_excel.py                  # 데이터 읽기 및 처리 모듈
├── generate_report.py             # HTML 보고서 생성 모듈
├── requirements.txt               # Python 의존성 목록
├── processed_inventory.csv        # 처리된 데이터 (생성됨)
├── inventory_report_YYYYMMDD_HHMMSS.html  # 생성된 보고서
└── README.md                      # 프로젝트 문서
```

## 🔧 상세 기능

### read_excel.py - 데이터 처리 엔진

#### 주요 기능:
- **지능형 파일 감지**: 여러 Excel 엔진(openpyxl, xlrd, calamine) 순차 시도
- **인코딩 자동 감지**: UTF-8, CP949 등 한국어 인코딩 지원
- **데이터 검증**: 필수 컬럼 존재 여부 확인 및 대체 컬럼 제안
- **런웨이 계산**: 현재 재고량 ÷ 월평균 사용량으로 소진 예상 기간 계산
- **오류 복구**: LibreOffice를 통한 파일 변환 백업 시스템

#### 런웨이 계산 로직:
```python
runway_months = 재고수량 / 월평균_조제수량

# 표시 형식:
# 1개월 이상: "X.XX개월"
# 1개월 미만: "X.XX일" (1개월 = 30.417일)
```

### generate_report.py - 시각화 및 보고서

#### 보고서 구성요소:

1. **대시보드 요약**
   - 총 약품 수
   - 재고 없는 약품 수
   - 과다 재고 약품 수 (6개월 이상)
   - 총 재고 가치

2. **인터랙티브 차트**
   - 재고 분포 히스토그램
   - TOP 20 약품별 재고량
   - 제약회사별 재고 분포
   - 런웨이 분포 분석

3. **상세 데이터 테이블**
   - 실시간 검색 기능
   - 컬럼별 정렬
   - 페이지네이션
   - 모바일 반응형

4. **경고 시스템**
   - 재고 부족 약품 (1개월 미만)
   - 과다 재고 약품 (6개월 초과)
   - 색상 코딩으로 위험도 표시

#### 기술 스택:
- **Backend**: Python, Pandas
- **Visualization**: Plotly.js
- **Frontend**: HTML5, CSS3, JavaScript
- **Styling**: 현대적인 그라디언트 디자인, 반응형 그리드

## 📊 샘플 데이터

프로젝트에 포함된 샘플 데이터:
- 3개월, 6개월, 9개월, 12개월 기간별 사용량 데이터
- Excel 및 CSV 형태로 제공
- 실제 약국 운영 패턴을 반영한 테스트 데이터

## 🛠️ 고급 설정

### 컬럼 매핑 커스터마이징

`read_excel.py`의 `required_columns` 리스트를 수정하여 다른 컬럼명 지원:

```python
required_columns = ['약품명', '제약회사', '약품코드', '재고수량', '조제수량']
```

### 보고서 스타일 커스터마이징

`generate_report.py`의 CSS 섹션을 수정하여 색상, 폰트, 레이아웃 변경 가능

### 알림 임계값 설정

런웨이 경고 기준 변경:
```python
# 1개월 미만 -> 부족 경고
# 6개월 초과 -> 과다 경고
```

## 🔍 문제 해결

### 일반적인 오류 및 해결방법

1. **파일 읽기 오류**
   ```
   해결: Excel에서 .xlsx 형식으로 재저장 또는 CSV 변환
   ```

2. **컬럼명 불일치**
   ```
   해결: 프로그램이 자동으로 유사한 컬럼명 제안
   ```

3. **인코딩 오류**
   ```
   해결: UTF-8, CP949 자동 감지 및 변환
   ```